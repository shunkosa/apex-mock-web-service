![](https://img.shields.io/badge/coverage-100%25-brightgreen.svg)

[English](README.md) | [日本語](README.ja.md)

# Apex モック Web サービス

簡単に設定できる Salesforce 上の API モックパッケージです。連携先のシステムの API が利用できない場合などに、テスト目的で連携先の モック API を構築することが主なユースケースです。これは Salesforce 上の連携開発を効率的に進めるために開発されましたが、実態は Apex REST Web サービスのため、Salesforce 以外の他のシステムからコールするための モック API としても活用することができます。

![](img/overview.png)

## 設定手順

1. `mock-web-service` フォルダの資源をデプロイします。

2. 静的リソースに API レスポンスとなる JSON ファイルを束ねた zip ファイルをアップロードします。

3. カスタムメタデータ `Mock Web Service Setting` にレコードを追加して、パスとレスポンスの JSON ファイルの対応およびステータスコードを設定します。

4. https://YourDomain.my.salesforce.com/apexrest/mock/* が モック API のエンドポイントです。任意の方法でアクセストークンを取得し、この API をコールします。Salesforce 開発者の場合は、必要に応じて以下のサンプルアプリケーションの設定手順も参照してください。

## サンプルアプリケーションのための追加設定
実際の連携をイメージしやすくするために、以下では、連携開発用の組織とモック API 用組織を分けて手順を示していますが、これらは同じ 1 つの組織でも構いません。

### モック API 用の組織

1. `mock-web-service-sample` フォルダのメタデータをデプロイします。

2. 接続アプリケーション `Apex Mock Web Service` のコンシューマー鍵とコンシューマの秘密を控えます。後ほど他の設定で使用します。

### 連携開発用の組織

1. `app-sample` フォルダのメタデータをデプロイします。

2. 認証プロバイダ `Mock API` のコンシューマーの鍵とコンシューマーの秘密を、モック API 用組織の接続アプリケーションのコンシューマー鍵とコンシューマの秘密の値に設定し保存します。

3. コールバック URL を控えます。モック API 用組織の接続アプリケーションに戻り、コールバック URL 項目の値をこの値で更新します。

4. 指定ログイン情報 `Mock API` の URL をモック API 用組織の URL に更新します。

5. 外部ログイン情報 `Mock API` に移動し、 `Example` プリンシパルのアクションボタンから、[認証] をクリックします。

6. モック API 用の組織にログインし、アクセスを許可します。

7. 権限セット `Apex Mock Web Service Sample App` をユーザに割り当てます。

8. `Example Order History` コンポーネントを、取引先の Lightning レコードページの任意の場所に配置します。取引先番号を `0001`、`0002`、または `0003` に設定します。静的リソース内の JSON ファイルに基づいて注文履歴の表示を確認することができます。

![](img/account_detail.png)

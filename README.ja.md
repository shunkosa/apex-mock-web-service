[English](README.md) | [日本語](README.ja.md)

# Apex コールアウト用の スタブ Web サービス

簡単に設定できる Salesforce 上の スタブ API パッケージです。連携先のシステムの API が利用できない場合などに、テスト目的で連携先の スタブ API を構築することが主なユースケースです。

![](img/overview.png)

## 設定手順

スタブ API サーバ用の組織と連携を開発する組織は同一にすることもできます。

### スタブ API サーバ用の組織

1. スクラッチ組織設定ファイルの機能に `"ZipSupportInApex"` を追加した上で新しいスクラッチ組織を作成します。

2. `stub-webservice` フォルダの資源をデプロイします。

3. 接続アプリケーション `Apex Stub Webservice` のコンシューマーの鍵とコンシューマーの秘密を控えます。後ほど他の設定で利用します。

### 連携開発用の組織

1. `app-sample` フォルダのメタデータをデプロイします。

2. 認証プロバイダ `Stub API` のコンシューマーの鍵とコンシューマーの秘密を、先ほど控えた接続アプリケーションの値に設定し保存します。

3. コールバック URL を控えます。スタブ API サーバ用組織の接続アプリケーションに戻り、コールバック URL 項目の値をこの値で更新します。

4. 指定ログイン情報 `Stub API` の URL をスタブ API サーバ用組織の URL に更新します。

5. 外部ログイン情報 `Stub API` に移動し、 `Example` プリンシパルのアクションボタンから、[認証] をクリックします。

6. スタブ API サーバ用の組織にログインし、アクセスを許可します。

## サンプルアプリケーションのための追加設定

### スタブ API サーバ用の組織

1. `stub-webservice-sample` フォルダのメタデータをデプロイします。

### 連携開発用の組織

1. 権限セット `Apex Stub Webservice Sample App` をユーザに割り当てます。

2. `Example Order History` コンポーネントを、取引先の Lightning レコードページの任意の場所に配置します。取引先番号を `0001`、`0002`、または `0003` に設定します。静的リソース内の JSON ファイルに基づいて注文履歴の表示を確認することができます。

![](img/account_detail.png)
